# metbit

Metbit is a Python package designed for the analysis of metabolomics data. It provides a range of tools and functions to process, visualize, and interpret metabolomics datasets. With Metbit, you can perform various statistical analyses, identify biomarkers, and generate informative visualizations to gain insights into your metabolomics experiments. Whether you are a researcher, scientist, or data analyst working in the field of metabolomics, Metbit can help streamline your data analysis workflow and facilitate the interpretation of complex metabolomics data.


# How to install

```bash
pip install metbit
```

# Example:

## **Principal component analysis**

PCA is used to transform a large set of variables into a smaller one that still contains most of the information in the large set. This is particularly useful when dealing with high-dimensional data, where visualizing and analyzing the data can be challenging.


To perform Principal Component Analysis (PCA) in a Python environment, you can use the metbit library. Here's a step-by-step guide to import the necessary package and perform PCA:

```python

import pandas as pd
from metbit import pca

df = pd.read_csv("metbit_tutorial_data.csv")
df.iloc[:10, :10]
```
| Group   |   Time point |       0.0 |   0.0001716414 |   0.0003432828 |   0.0005149242 |   0.0006865656 |   0.000858207 |   0.0010298484 |   0.0012014898 |
|:--------|-------------:|----------:|---------------:|---------------:|---------------:|---------------:|--------------:|---------------:|---------------:|
| Group B |            3 |  3024.2   |       3923.9   |       4758.23  |       4551.28  |       3737.53  |      3469.81  |       3646.49  |      3278.41   |
| Group A |            3 |  3776.08  |       3441.18  |       3479.89  |       4102.29  |       5089.12  |      6000.92  |       6556.49  |      6687.83   |
| Group A |            2 |  3823.99  |       3227.06  |       2793.23  |       2544.2   |       2254.06  |      1843.89  |       1470.21  |      1362.43   |
| Group B |            2 | 21926     |      21546.2   |      21155.6   |      20190.6   |      18755.6   |     17993.4   |      18545.5   |     19496.6    |
| Group A |            4 |  2997.22  |       2130.68  |       1993.8   |       2948.87  |       4414.49  |      5267.69  |       4897.94  |      3868.98   |
| Group B |            4 | 12988.5   |      14361.2   |      15288.7   |      15439.6   |      15410.4   |     15513.2   |      15528     |     15446.5    |
| Group A |            2 |   202.293 |        111.968 |        640.931 |       1732.62  |       2926.78  |      3299.18  |       2308.54  |       783.053  |
| Group A |            3 |  4813.91  |       4822.44  |       4153.81  |       2861.74  |       1405.9   |       575.416 |        725.433 |      1315.78   |
| Group A |            4 | 34822.5   |      34380.2   |      33536.9   |      32369.3   |      31296.5   |     30737.1   |      30694.3   |     30909.4    |
| Group A |            4 |   124.841 |        677.809 |        841.232 |        659.092 |        479.715 |       438.279 |        323.827 |       -43.9303 |


```python
X = df.iloc[:, 2:]
ppm = X.columns.astype(float).to_list()
color_ = df["Group"]
symbol_ = df["Time point"] 
time_order = {1:0, 2:1, 3:2, 4:2} #Create dict of time order

pca_mod = pca(X=X, label=color_, features_name=ppm, n_components=3)
pca_mod.fit()
```

# Visualisation of PCA model

```python
pca_mod.plot_pca_scores(pc=["PC1", "PC2"], symbol_=symbol_).write_html("pca_scores[PC1-PC2].html")
```
![plot](https://github.com/aeiwz/metbit/blob/main/src/img/pca_scores%5BPC1-PC2%5D.html)


# OPLS-DA model

## Import package into python

```python

from metbit import opls_da
import pandas as pd
import numpy as np
```

## Load dataset
For example dataset are generated by random

```python
data = pd.DataFrame(np.random.rand(500, 50000))
class_ = pd.Series(np.random.choice(['A', 'B'], 500), name='Group')

datasets = pd.concat([class_, data], axis=1)


# Assign X and target
X = datasets.iloc[:, 2:]
y = datasets['Group']
time = datasets['Time point']
features_name = list(X.columns.astype(float))
```

## Perform OPLS-DA model

```python

opls_da_model = opls_da(X=X, y=y,features_name=features_name, n_components=2, scale='pareto', kfold=3, estimator='opls', random_state=42):
        
opls_da_model.fit()

opls_da_model.permutation_test(n_permutataion=1000,cv=3, n_jobs=-1, verbose=10)

opls_da_model.vip_scores()


```


## Visualisation of OPLS-DA model


```python

opls_da_model.plot_oplsda_scores()

opls_da_model.vip_plot()

opls_da_model.plot_hist()

opls_da_model.plot_s_scores()

opls_da_model.plot_loading()

```

